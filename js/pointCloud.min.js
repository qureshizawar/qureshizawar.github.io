import{OrbitControls}from"./OrbitControls.min.js";import*as THREE from"https://unpkg.com/three/build/three.module.js";window.createPointCloud=function(e,n,t,r){var o;var a=new THREE.WebGLRenderer({antialias:!0}),i=r[0].length,l=r.length;a.setSize(i,l),a.domElement.id="depth_canvas";var d=document.getElementById("depth_sec"),s=document.getElementById("depth_canvas");a.setClearColor(15658734,1);var c=new THREE.Scene,m=new THREE.PerspectiveCamera(function(e,n){return 120.3704-e/n*36.41975+4.115226*Math.pow(e/n,2)}(i,l),i/l,1,1e4);m.position.z=200,m.position.x=100,m.position.y=100;var E=new THREE.Object3D;c.add(E),E.rotation.y=0;for(var u=[],g=(d3.format("+.3f"),0);g<e.length;g++)for(var h=0;h<e[0].length;h++)u[g*e[0].length+h]={x:n[g][h],y:-e[g][h],z:t[g][h],r:r[g][h][0],g:r[g][h][1],b:r[g][h][2]};var p=d3.extent(u,(function(e){return e.x})),v=d3.extent(u,(function(e){return e.y})),w=d3.extent(u,(function(e){return e.z})),f=(p[1],p[1],p[0],p[0],v[1],v[1],v[0],v[0],w[1],w[1],w[0],w[0],d3.scale.category20c(),d3.scale.linear().domain(p).range([-i/3,i/3])),R=d3.scale.linear().domain(v).range([-l/3,l/3]),x=d3.scale.linear().domain(w).range([-100,100]),C=new THREE.PointsMaterial({vertexColors:!0,size:.85*window.devicePixelRatio}),H=u.length,T=new THREE.Geometry;for(g=0;g<H;g++){var b=f(u[g].x),y=R(u[g].y),P=x(u[g].z);T.vertices.push(new THREE.Vector3(b,y,P)),T.colors.push((new THREE.Color).setRGB(u[g].r/255,u[g].g/255,u[g].b/255))}var z=new THREE.Points(T,C);E.add(z),d.replaceChild(a.domElement,s),(o=new OrbitControls(m,a.domElement)).enableDamping=!1,o.screenSpacePanning=!1,o.minDistance=100,o.maxDistance=500,o.maxPolarAngle=Math.PI/2,function e(){requestAnimationFrame(e),a.render(c,m)}()};