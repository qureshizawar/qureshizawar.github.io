const color="aqua",boundingBoxColor="red",lineWidth=2;function isAndroid(){return/Android/i.test(navigator.userAgent)}function isiOS(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}function isMobile(){return isAndroid()||isiOS()}function toggleLoadingUI(t,e="loading",i="main"){t?(document.getElementById(e).style.display="block",document.getElementById(i).style.display="none"):(document.getElementById(e).style.display="none",document.getElementById(i).style.display="block")}function toTuple({y:t,x:e}){return[t,e]}async function renderToCanvas(t,e){const[i,a]=t.shape,n=new ImageData(a,i),o=await t.data();for(let t=0;t<i*a;++t){const e=4*t,i=3*t;n.data[e+0]=o[i+0],n.data[e+1]=o[i+1],n.data[e+2]=o[i+2],n.data[e+3]=255}e.putImageData(n,0,0)}function renderImageToCanvas(t,e,i){i.width=e[0],i.height=e[1],i.getContext("2d").drawImage(t,0,0)}function set_static_output_size(t){t.clientWidth>t.naturalWidth&&t.clientHeight>t.naturalHeight?(output_HEIGHT=t.clientHeight,output_WIDTH=Math.round(t.naturalWidth/t.naturalHeight*output_HEIGHT),output_WIDTH>t.clientWidth&&(output_WIDTH=t.clientWidth,output_HEIGHT=Math.round(t.naturalHeight/t.naturalWidth*output_WIDTH))):t.clientWidth<t.naturalWidth&&t.clientHeight<t.naturalHeight?(output_WIDTH=t.clientWidth,output_HEIGHT=Math.round(t.naturalHeight/t.naturalWidth*output_WIDTH),output_HEIGHT>t.clientHeight&&(output_HEIGHT=t.clientHeight,output_WIDTH=Math.round(t.naturalWidth/t.naturalHeight*output_HEIGHT))):t.clientWidth<t.naturalWidth?(output_WIDTH=t.clientWidth,output_HEIGHT=Math.round(t.naturalHeight/t.naturalWidth*output_WIDTH)):(output_HEIGHT=t.clientHeight,output_WIDTH=Math.round(t.naturalWidth/t.naturalHeight*output_HEIGHT))}async function setupCamera(t){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Browser API navigator.mediaDevices.getUserMedia not available");const e=document.getElementById("video");e.width=videoWidth,e.height=videoHeight;const i=await navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"rear"==t?"environment":"user",width:mobile?void 0:videoWidth,height:mobile?void 0:videoHeight}});return e.srcObject=i,new Promise(t=>{e.onloadedmetadata=()=>{t(e)}})}async function loadVideo(t){const e=await setupCamera(t);return e.play(),e}